MERGE
INTO
	RI_PHONGLQ D
		USING (
	SELECT
		RI_ID,
		UNQ_ID_IN_SRC_STM,
		RI_TP_ID,
		PPN_DT,
		REC_IND
	FROM
		TWT_RI_PHONGLQ
	WHERE
		REC_IND IN ('U', 'I')) S ON (D.RI_ID = S.RI_ID)
	WHEN MATCHED THEN
		UPDATE
		SET
			D.UNQ_ID_IN_SRC_STM = S.UNQ_ID_IN_SRC_STM,
			D.RI_TP_ID = S.RI_TP_ID,
			D.PPN_DT = S.PPN_DT
	WHEN NOT MATCHED 
		THEN INSERT (RI_ID,
	UNQ_ID_IN_SRC_STM,
	RI_TP_ID,
	PPN_DT)
VALUES ( S.RI_ID,
S.UNQ_ID_IN_SRC_STM,
S.RI_TP_ID,
S.PPN_DT
); COMMIT;